!function e(t,r,n){function i(o,u){if(!r[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);var p=new Error("Cannot find module '"+o+"'");throw p.code="MODULE_NOT_FOUND",p}var c=r[o]={exports:{}};t[o][0].call(c.exports,function(e){var r=t[o][1][e];return i(r?r:e)},c,c.exports,e,t,r,n)}return r[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,r){(function(e){!function(t){function r(){this._pieces=[],this._parts=[]}function n(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function i(){this.bufferBuilder=new r}function s(e){var t=e.charCodeAt(0);return 2047>=t?"00":65535>=t?"000":2097151>=t?"0000":67108863>=t?"00000":"000000"}function o(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,s).length}function u(){this._events={}}function a(){u.call(this)}function p(e,t){a.call(this),t=v.extend({readDelay:0,paused:!1},t),this._source=e,this._start=0,this._readChunkSize=t.chunkSize||e.size,this._readDelay=t.readDelay,this.readable=!0,this.paused=t.paused,this._read()}function c(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function h(e,t,r,n){if(!(this instanceof h))return new h(options);var i=this;a.call(this),this.id=t,this.guid=c(),this._socket=e,this.writable=!0,this.readable=!0,this.paused=!1,this._closed=!1,this._ended=!1,r&&(n.guid=i.guid,this._write(1,n,this.id))}function f(e,t){if(!(this instanceof f))return new f(e,t);u.call(this);var r=this;this._options=v.extend({chunkSize:40960},t),this.streams={},"string"==typeof e?(this._nextId=0,this._socket=new WebSocket(e)):(this._nextId=1,this._socket=e),this._socket.binaryType="arraybuffer",this._socket.addEventListener("open",function(){r.emit("open")}),this._socket.addEventListener("error",function(e){for(var t=Object.keys(r.streams),n=0,i=t.length;i>n;n++)r.streams[t[n]]._onError(e);r.emit("error",e)}),this._socket.addEventListener("close",function(e,t){for(var n=Object.keys(r.streams),i=0,s=n.length;s>i;i++)r.streams[n[i]]._onClose();r.emit("close",e,t)}),this._socket.addEventListener("message",function(e,t){v.setZeroTimeout(function(){e=e.data;try{e=v.unpack(e)}catch(t){return r.emit("error",new Error("Received unparsable message: "+t))}if(!(e instanceof Array))return r.emit("error",new Error("Received non-array message"));if(3!=e.length)return r.emit("error",new Error("Received message with wrong part count: "+e.length));if("number"!=typeof e[0])return r.emit("error",new Error("Received message with non-number type: "+e[0]));switch(e[0]){case 0:break;case 1:var n=e[1],i=e[2],s=r._receiveStream(i,n.guid);r.emit("stream",s,n);break;case 2:var o=e[1],i=e[2],s=r.streams[i];s?s._onData(o):r.emit("error",new Error("Received `data` message for unknown stream: "+i));break;case 3:var i=e[2],s=r.streams[i];s?s._onPause():r.emit("error",new Error("Received `pause` message for unknown stream: "+i));break;case 4:var i=e[2],s=r.streams[i];s?s._onResume():r.emit("error",new Error("Received `resume` message for unknown stream: "+i));break;case 5:var i=e[2],s=r.streams[i];s?s._onEnd():r.emit("error",new Error("Received `end` message for unknown stream: "+i));break;case 6:var i=e[2],s=r.streams[i];s?s._onClose():r.emit("error",new Error("Received `close` message for unknown stream: "+i));break;case 7:var u=e[1],i=e[2],s=r.streams[i];s?s._onError(u):r.emit("error",new Error("Received `error` message for unknown stream: "+i));break;case 8:var a=e[1],i=e[2],s=r.streams[i];s?s._onCreateClientConnection(a):r.emit("error",new Error("Received `error` message for unknown stream: "+i));break;case 9:var p=e[1][0],c=e[1][1],i=e[2],s=r.streams[i];s?s._onMessage(p,c):r.emit("error",new Error("Received `error` message for unknown stream: "+i));break;default:r.emit("error",new Error("Unrecognized message type received: "+e[0]))}})})}var l={};l.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),l.useArrayBufferView=!l.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),l.supportsBinaryWebsockets=function(){try{var e=new WebSocket("ws://null");return e.onerror=function(){},"undefined"!=typeof e.binaryType}catch(t){return!1}}(),t.binaryFeatures=l,t.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder,r.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},r.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);l.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},r.prototype.getBuffer=function(){if(this.flush(),l.useBlobBuilder){for(var e=new BlobBuilder,t=0,r=this._parts.length;r>t;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.BinaryPack={unpack:function(e){var t=new n(e);return t.unpack()},pack:function(e){var t=new i;t.pack(e);var r=t.getBuffer();return r}},n.prototype.unpack=function(){var e=this.unpack_uint8();if(128>e){var t=e;return t}if(32>(224^e)){var r=(224^e)-32;return r}var n;if((n=160^e)<=15)return this.unpack_raw(n);if((n=176^e)<=15)return this.unpack_string(n);if((n=144^e)<=15)return this.unpack_array(n);if((n=128^e)<=15)return this.unpack_map(n);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return n=this.unpack_uint16(),this.unpack_string(n);case 217:return n=this.unpack_uint32(),this.unpack_string(n);case 218:return n=this.unpack_uint16(),this.unpack_raw(n);case 219:return n=this.unpack_uint32(),this.unpack_raw(n);case 220:return n=this.unpack_uint16(),this.unpack_array(n);case 221:return n=this.unpack_uint32(),this.unpack_array(n);case 222:return n=this.unpack_uint16(),this.unpack_map(n);case 223:return n=this.unpack_uint32(),this.unpack_map(n)}},n.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},n.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},n.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},n.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},n.prototype.unpack_int8=function(){var e=this.unpack_uint8();return 128>e?e:e-256},n.prototype.unpack_int16=function(){var e=this.unpack_uint16();return 32768>e?e:e-65536},n.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},n.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},n.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},n.prototype.unpack_string=function(e){for(var t,r,n=this.read(e),i=0,s="";e>i;)t=n[i],128>t?(s+=String.fromCharCode(t),i++):32>(192^t)?(r=(192^t)<<6|63&n[i+1],s+=String.fromCharCode(r),i+=2):(r=(15&t)<<12|(63&n[i+1])<<6|63&n[i+2],s+=String.fromCharCode(r),i+=3);return this.index+=e,s},n.prototype.unpack_array=function(e){for(var t=new Array(e),r=0;e>r;r++)t[r]=this.unpack();return t},n.prototype.unpack_map=function(e){for(var t={},r=0;e>r;r++){var n=this.unpack(),i=this.unpack();t[n]=i}return t},n.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=e>>31,r=(e>>23&255)-127,n=8388607&e|8388608;return(0==t?1:-1)*n*Math.pow(2,r-23)},n.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),r=e>>31,n=(e>>20&2047)-1023,i=1048575&e|1048576,s=i*Math.pow(2,n-20)+t*Math.pow(2,n-52);return(0==r?1:-1)*s},n.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},i.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},i.prototype.pack=function(e){var t=typeof e;if("string"==t)this.pack_string(e);else if("number"==t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"==t)e===!0?this.bufferBuilder.append(195):e===!1&&this.bufferBuilder.append(194);else if("undefined"==t)this.bufferBuilder.append(192);else{if("object"!=t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var r=e.constructor;if(r==Array)this.pack_array(e);else if(r==Blob||r==File)this.pack_bin(e);else if(r==ArrayBuffer)l.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)l.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(r==Object)this.pack_object(e);else if(r==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+r.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},i.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(15>=t)this.pack_uint8(160+t);else if(65535>=t)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(4294967295>=t))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},i.prototype.pack_string=function(e){var t=o(e);if(15>=t)this.pack_uint8(176+t);else if(65535>=t)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(4294967295>=t))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},i.prototype.pack_array=function(e){var t=e.length;if(15>=t)this.pack_uint8(144+t);else if(65535>=t)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(4294967295>=t))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var r=0;t>r;r++)this.pack(e[r])},i.prototype.pack_integer=function(e){if(e>=-32&&127>=e)this.bufferBuilder.append(255&e);else if(e>=0&&255>=e)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&127>=e)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&65535>=e)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&32767>=e)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&4294967295>=e)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&2147483647>=e)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-0x8000000000000000&&0x8000000000000000>=e)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(e>=0&&0x10000000000000000>=e))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},i.prototype.pack_double=function(e){var t=0;0>e&&(t=1,e=-e);var r=Math.floor(Math.log(e)/Math.LN2),n=e/Math.pow(2,r)-1,i=Math.floor(n*Math.pow(2,52)),s=Math.pow(2,32),o=t<<31|r+1023<<20|i/s&1048575,u=i%s;this.bufferBuilder.append(203),this.pack_int32(o),this.pack_int32(u)},i.prototype.pack_object=function(e){var t=Object.keys(e),r=t.length;if(15>=r)this.pack_uint8(128+r);else if(65535>=r)this.bufferBuilder.append(222),this.pack_uint16(r);else{if(!(4294967295>=r))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(r)}for(var n in e)e.hasOwnProperty(n)&&(this.pack(n),this.pack(e[n]))},i.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},i.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},i.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},i.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),r=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&r)>>>24),this.bufferBuilder.append((16711680&r)>>>16),this.bufferBuilder.append((65280&r)>>>8),this.bufferBuilder.append(255&r)},i.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},i.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},i.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},i.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),r=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&r)>>>24),this.bufferBuilder.append((16711680&r)>>>16),this.bufferBuilder.append((65280&r)>>>8),this.bufferBuilder.append(255&r)};var d=Array.isArray;u.prototype.addListener=function(e,t,r,n){if("function"!=typeof t)throw new Error("addListener only takes instances of Function");return this.emit("newListener",e,"function"==typeof t.listener?t.listener:t),this._events[e]?d(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,this},u.prototype.on=u.prototype.addListener,u.prototype.once=function(e,t,r){function n(){i.removeListener(e,n),t.apply(this,arguments)}if("function"!=typeof t)throw new Error(".once only takes instances of Function");var i=this;return n.listener=t,i.on(e,n),this},u.prototype.removeListener=function(e,t,r){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");if(!this._events[e])return this;var n=this._events[e];if(d(n)){for(var i=-1,s=0,o=n.length;o>s;s++)if(n[s]===t||n[s].listener&&n[s].listener===t){i=s;break}if(0>i)return this;n.splice(i,1),0==n.length&&delete this._events[e]}else(n===t||n.listener&&n.listener===t)&&delete this._events[e];return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(e){return 0===arguments.length?(this._events={},this):(e&&this._events&&this._events[e]&&(this._events[e]=null),this)},u.prototype.listeners=function(e){return this._events[e]||(this._events[e]=[]),d(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},u.prototype.emit=function(e){var e=arguments[0],t=this._events[e];if(!t)return!1;if("function"==typeof t){switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:for(var r=arguments.length,n=new Array(r-1),i=1;r>i;i++)n[i-1]=arguments[i];t.apply(this,n)}return!0}if(d(t)){for(var r=arguments.length,n=new Array(r-1),i=1;r>i;i++)n[i-1]=arguments[i];for(var s=t.slice(),i=0,r=s.length;r>i;i++)s[i].apply(this,n);return!0}return!1};var v={inherits:function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},extend:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},pack:t.BinaryPack.pack,unpack:t.BinaryPack.unpack,setZeroTimeout:function(e){function t(t){n.push(t),e.postMessage(i,"*")}function r(t){t.source==e&&t.data==i&&(t.stopPropagation&&t.stopPropagation(),n.length&&n.shift()())}var n=[],i="zero-timeout-message";return e.addEventListener?e.addEventListener("message",r,!0):e.attachEvent&&e.attachEvent("onmessage",r),t}(this)};t.util=v,v.inherits(a,u),a.prototype.pipe=function(e,t){function r(t){e.writable&&!1===e.write(t)&&a.pause&&a.pause()}function n(){a.readable&&a.resume&&a.resume()}function i(){p||(p=!0,e.end())}function s(){p||(p=!0,e.destroy())}function o(e){if(u(),0===this.listeners("error").length)throw e}function u(){a.removeListener("data",r),e.removeListener("drain",n),a.removeListener("end",i),a.removeListener("close",s),a.removeListener("error",o),e.removeListener("error",o),a.removeListener("end",u),a.removeListener("close",u),e.removeListener("end",u),e.removeListener("close",u)}var a=this;a.on("data",r),e.on("drain",n),e._isStdio||t&&t.end===!1||(a.on("end",i),a.on("close",s));var p=!1;return a.on("error",o),e.on("error",o),a.on("end",u),a.on("close",u),e.on("end",u),e.on("close",u),e.emit("pipe",a),e},t.Stream=a,v.inherits(p,a),p.prototype.pause=function(){this.paused=!0},p.prototype.resume=function(){this.paused=!1,this._read()},p.prototype.destroy=function(){this.readable=!1,clearTimeout(this._timeoutId)},p.prototype._read=function(){function e(){t._emitReadChunk()}var t=this,r=this._readDelay;0!==r?this._timeoutId=setTimeout(e,r):v.setZeroTimeout(e)},p.prototype._emitReadChunk=function(){if(!this.paused&&this.readable){var e=Math.min(this._source.size-this._start,this._readChunkSize);if(0===e)return this.readable=!1,void this.emit("end");var t=this._start+e,r=(this._source.slice||this._source.webkitSlice||this._source.mozSlice).call(this._source,this._start,t);this._start=t,this._read(),this.emit("data",r)}},t.BlobReadStream=p,v.inherits(h,a),h.prototype.guid=void 0,h.prototype._onDrain=function(){this.paused||this.emit("drain")},h.prototype._onClose=function(){this._closed||(this.readable=!1,this.writable=!1,this._closed=!0,this.emit("close"))},h.prototype._onError=function(e){this.readable=!1,this.writable=!1,this.emit("error",e)},h.prototype._onMessage=function(e,t){this.emit(e,t)},h.prototype._onCreateClientConnection=function(e){this.emit("createClientConnection",e)},h.prototype._onPause=function(){this.paused=!0,this.emit("pause")},h.prototype._onResume=function(){this.paused=!1,this.emit("resume"),this.emit("drain")},h.prototype._write=function(e,t,r){if(this._socket.readyState!==this._socket.constructor.OPEN)return!1;var n=v.pack([e,t,r]);return this._socket.send(n)!==!1},h.prototype.write=function(e){if(this.writable){var t=this._write(2,e,this.id);return!this.paused&&t}return this.emit("error",new Error("Stream is not writable")),!1},h.prototype.end=function(){this._ended=!0,this.readable=!1,this._write(5,null,this.id)},h.prototype.error=function(e){this._ended=!0,this.readable=!1,this._write(7,e,this.id)},h.prototype.createClientConnection=function(e){this._write(8,e,this.id)},h.prototype.message=function(e,t){this._write(9,[e,t],this.id)},h.prototype.destroy=h.prototype.destroySoon=function(){this._onClose(),this._write(6,null,this.id)},h.prototype._onEnd=function(){this._ended||(this._ended=!0,this.readable=!1,this.emit("end"))},h.prototype._onData=function(e){this.emit("data",e)},h.prototype.pause=function(){this._onPause(),this._write(3,null,this.id)},h.prototype.resume=function(){this._onResume(),this._write(4,null,this.id)},v.inherits(f,u),f.prototype.send=function(t,r){var n=this.createStream(r);if(t instanceof a)t.pipe(n);else if(v.isNode===!0)e.isBuffer(t)?new BufferReadStream(t,{chunkSize:this._options.chunkSize}).pipe(n):n.write(t);else if(v.isNode!==!0)if(t.constructor==Blob||t.constructor==File)new p(t,{chunkSize:this._options.chunkSize}).pipe(n);else if(t.constructor==ArrayBuffer){var i;if(l.useArrayBufferView&&(t=new Uint8Array(t)),l.useBlobBuilder){var s=new BlobBuilder;s.append(t),i=s.getBlob()}else i=new Blob([t]);new p(i,{chunkSize:this._options.chunkSize}).pipe(n)}else if("object"==typeof t&&"BYTES_PER_ELEMENT"in t){var i;if(l.useArrayBufferView||(t=t.buffer),l.useBlobBuilder){var s=new BlobBuilder;s.append(t),i=s.getBlob()}else i=new Blob([t]);new p(i,{chunkSize:this._options.chunkSize}).pipe(n)}else n.write(t);return n},f.prototype._receiveStream=function(e,t){var r=this,n=new h(this._socket,e,!1);return n.guid=t,n.on("close",function(){delete r.streams[e]}),this.streams[e]=n,n},f.prototype.createStream=function(e){if(this._socket.readyState!==WebSocket.OPEN)throw new Error("Client is not yet connected or has closed");var t=this,r=this._nextId;this._nextId+=2;var n=new h(this._socket,r,!0,e);return n.on("close",function(){delete t.streams[r]}),this.streams[r]=n,n},f.prototype.close=f.prototype.destroy=function(){this._socket.close()},t.BinaryClient=f}(this)}).call(this,{isBuffer:e("../node_modules/browserify/node_modules/insert-module-globals/node_modules/is-buffer/index.js")})},{"../node_modules/browserify/node_modules/insert-module-globals/node_modules/is-buffer/index.js":3}],2:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function s(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function u(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!s(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,s,a,p;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[e],u(r))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,s=new Array(n-1),a=1;n>a;a++)s[a-1]=arguments[a];r.apply(this,s)}else if(o(r)){for(n=arguments.length,s=new Array(n-1),a=1;n>a;a++)s[a-1]=arguments[a];for(p=r.slice(),n=p.length,a=0;n>a;a++)p[a].apply(this,s)}return!0},n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned){var r;r=u(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var n=!1;return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var r,n,s,u;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],s=r.length,n=-1,r===t||i(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(u=s;u-- >0;)if(r[u]===t||r[u].listener&&r[u].listener===t){n=u;break}if(0>n)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],i(r))this.removeListener(e,r);else for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var r;return r=e._events&&e._events[t]?i(e._events[t])?1:e._events[t].length:0}},{}],3:[function(e,t,r){t.exports=function(e){return!(null==e||!(e._isBuffer||e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)))}},{}],4:[function(e,t,r){var n,i=Object.prototype.hasOwnProperty,s=Object.prototype.toString,o=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===s.call(e)},u=function(e){"use strict";if(!e||"[object Object]"!==s.call(e))return!1;var t=i.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&i.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!r)return!1;var o;for(o in e);return o===n||i.call(e,o)};t.exports=function a(){"use strict";var e,t,r,i,s,p,c=arguments[0],h=1,f=arguments.length,l=!1;for("boolean"==typeof c?(l=c,c=arguments[1]||{},h=2):("object"!=typeof c&&"function"!=typeof c||null==c)&&(c={});f>h;++h)if(e=arguments[h],null!=e)for(t in e)r=c[t],i=e[t],c!==i&&(l&&i&&(u(i)||(s=o(i)))?(s?(s=!1,p=r&&o(r)?r:[]):p=r&&u(r)?r:{},c[t]=a(l,p,i)):i!==n&&(c[t]=i));return c}},{}],5:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],6:[function(e,t,r){"use strict";t.exports=e("./lib/index")},{"./lib/index":10}],7:[function(e,t,r){"use strict";function n(){f=!1}function i(e){if(!e)return void(c!==d&&(c=d,n()));if(e!==c){if(e.length!==d.length)throw new Error("Custom alphabet for shortid must be "+d.length+" unique characters. You submitted "+e.length+" characters: "+e);var t=e.split("").filter(function(e,t,r){return t!==r.lastIndexOf(e)});if(t.length)throw new Error("Custom alphabet for shortid must be "+d.length+" unique characters. These characters were not unique: "+t.join(", "));c=e,n()}}function s(e){return i(e),c}function o(e){l.seed(e),h!==e&&(n(),h=e)}function u(){c||i(d);for(var e,t=c.split(""),r=[],n=l.nextValue();t.length>0;)n=l.nextValue(),e=Math.floor(n*t.length),r.push(t.splice(e,1)[0]);return r.join("")}function a(){return f?f:f=u()}function p(e){var t=a();return t[e]}var c,h,f,l=e("./random/random-from-seed"),d="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";t.exports={characters:s,seed:o,lookup:p,shuffled:a}},{"./random/random-from-seed":13}],8:[function(e,t,r){"use strict";function n(e){var t=i.shuffled();return{version:15&t.indexOf(e.substr(0,1)),worker:15&t.indexOf(e.substr(1,1))}}var i=e("./alphabet");t.exports=n},{"./alphabet":7}],9:[function(e,t,r){"use strict";function n(e,t){for(var r,n=0,s="";!r;)s+=e(t>>4*n&15|i()),r=t<Math.pow(16,n+1),n++;return s}var i=e("./random/random-byte");t.exports=n},{"./random/random-byte":12}],10:[function(e,t,r){"use strict";function n(){var e="",t=Math.floor(.001*(Date.now()-l));return t===a?u++:(u=0,a=t),e+=c(p.lookup,d),e+=c(p.lookup,v),u>0&&(e+=c(p.lookup,u)),e+=c(p.lookup,t)}function i(e){return p.seed(e),t.exports}function s(e){return v=e,t.exports}function o(e){return void 0!==e&&p.characters(e),p.shuffled()}var u,a,p=e("./alphabet"),c=e("./encode"),h=e("./decode"),f=e("./is-valid"),l=1459707606518,d=6,v=e("./util/cluster-worker-id")||0;t.exports=n,t.exports.generate=n,t.exports.seed=i,t.exports.worker=s,t.exports.characters=o,t.exports.decode=h,t.exports.isValid=f},{"./alphabet":7,"./decode":8,"./encode":9,"./is-valid":11,"./util/cluster-worker-id":14}],11:[function(e,t,r){"use strict";function n(e){if(!e||"string"!=typeof e||e.length<6)return!1;for(var t=i.characters(),r=e.length,n=0;r>n;n++)if(-1===t.indexOf(e[n]))return!1;return!0}var i=e("./alphabet");t.exports=n},{"./alphabet":7}],12:[function(e,t,r){"use strict";function n(){if(!i||!i.getRandomValues)return 48&Math.floor(256*Math.random());var e=new Uint8Array(1);return i.getRandomValues(e),48&e[0]}var i="object"==typeof window&&(window.crypto||window.msCrypto);t.exports=n},{}],13:[function(e,t,r){"use strict";function n(){return s=(9301*s+49297)%233280,s/233280}function i(e){s=e}var s=1;t.exports={nextValue:n,seed:i}},{}],14:[function(e,t,r){"use strict";t.exports=0},{}],15:[function(e,t,r){(function(r){var n=r.iobio||{};r.iobio=n,r.onbeforeunload=function(){r.iobioClients.forEach(function(e){try{e.client.close()}catch(t){}})},"object"==typeof t&&(t.exports=n);var i=e("events").EventEmitter,s=e("inherits"),o=e("shortid");n.cmd=function(t,r,n){i.call(this);var s=e("extend");this.options={id:o.generate()},s(this.options,n),this.protocol="ws",this.pipedCommands={},this.pipedCommands[this.options.id]=this,r=r||[];var u=e("./conn.js");this.connection=new u(this.protocol,t,r,this.options);e("./utils/bindStreamEvents")(this,this.connection)},s(n.cmd,i),n.cmd.prototype.pipe=function(e,t,r){t=t||[],t.push(this.url());var i=new n.cmd(e,t,r||{});for(var s in this.pipedCommands)i.pipedCommands[s]=this.pipedCommands[s];return i},n.cmd.prototype.url=function(){return"iobio://"+this.connection.uri},n.cmd.prototype.http=function(){return"http://"+this.connection.uri},n.cmd.prototype.ws=function(){return"ws://"+this.connection.uri},n.cmd.prototype.id=this.id,n.cmd.prototype.protocol=function(e){return arguments.length?(this.protocol=e,this):this.protocol},n.cmd.prototype.run=function(){this.connection.run(this.pipedCommands)},n.cmd.prototype.kill=function(){this.connection.runner.kill()},n.cmd.prototype.end=function(){this.connection.runner.end()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./conn.js":16,"./utils/bindStreamEvents":22,events:2,extend:4,inherits:5,shortid:6}],16:[function(e,t,r){(function(r){var n=e("events").EventEmitter,i=e("inherits"),s=function(t,r,i,s){n.call(this);this.opts=s,this.service=r,this.protocol=t,this.params=i;var o=e("./urlBuilder.js"),u=new o(r,i,s);this.urlBuilder=u,this.uri=u.uri,"ws"==t?this.Runner=e("./protocol/ws.js"):"http"==t&&(this.Runner=e("./protocol/http.js"))};i(s,n),s.prototype.run=function(t){this.runner=new this.Runner(this.urlBuilder,t,this.opts);r.iobioClients=r.iobioClients||[],r.iobioClients.push(this.runner),e("./utils/bindStreamEvents")(this,this.runner)},t.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./protocol/http.js":17,"./protocol/ws.js":18,"./urlBuilder.js":21,"./utils/bindStreamEvents":22,events:2,inherits:5}],17:[function(e,t,r){},{}],18:[function(e,t,r){var n=e("events").EventEmitter,i=e("inherits"),s=function(t,r,i){n.call(this);var s="ws://"+t.uri,o=e("binaryjs").BinaryClient,u=o(s),a=this;this.client=u,this.stream,u.on("open",function(e){var e=u.createStream({event:"run",params:{url:s}});a.stream=e,e.on("createClientConnection",function(e){var n,s=r[e.id];if(s)var u=s.options,a=s.connection.urlBuilder;else var u=i,a=t;n=e.serverAddress?e.serverAddress:u&&u.writeStream&&u.writeStream.serverAddress?u.writeStream.serverAddress:a.getService();var p=o("ws://"+n);p.on("open",function(){var t=p.createStream({event:"clientConnected",connectionID:e.id}),r=a.getFile();r.write(t,u)})}),e.on("data",function(e,t){a.emit("data",e)}),e.on("end",function(){a.emit("end")}),e.on("error",function(e){a.emit("error",e)}),e.on("queue",function(e){a.emit("queue",e)})})};i(s,n),s.prototype.kill=function(){this.stream.destroy()},s.prototype.end=function(){this.stream.end()},t.exports=s},{binaryjs:1,events:2,inherits:5}],19:[function(e,t,r){var n=e("binaryjs").BlobReadStream,i=function(e){var t=this;t.fileObj=e,t.url=encodeURIComponent("http://client")};i.prototype.getType=function(){return"file"},i.prototype.getFileObj=function(){return this.fileObj;
},i.prototype.getUrl=function(){return this.url},i.prototype.write=function(e,t){var r=t.chunkSize||512e3;t&&t.writeStream?t.writeStream(e,function(){e.end()}):new n(this.fileObj,{chunkSize:r}).pipe(e)},t.exports=i},{binaryjs:1}],20:[function(e,t,r){var n=function(e){var t="http"+e.slice(5,e.length);this.url=encodeURIComponent(t)};n.prototype.getType=function(){return"url"},n.prototype.getUrl=function(){return this.url},t.exports=n},{}],21:[function(e,t,r){var n=function(t,r,n){var i,s=e("./utils/hash2UrlParams.js"),o=(e("events").EventEmitter(),e("./source/file.js")),u=e("./source/url.js");n=n||{},this.uri=null,this.service=t;for(var a=this,p=0;p<r.length;p++)if("iobio://"==r[p].slice(0,8)){i="url";var c=new u(r[p]);r[p]=c.getUrl()}else"[object File]"!=Object.prototype.toString.call(r[p])&&"[object Blob]"!=Object.prototype.toString.call(r[p])||(i="file",a.file=new o(r[p]),r[p]=a.file.getUrl());this.uri=encodeURI(t+"?cmd="+r.join(" ")+s(n.urlparams)+s({id:n.id})),"file"==i&&(this.uri+="&protocol=websocket")};n.prototype.getFile=function(){return this.file},n.prototype.getService=function(){return this.service},t.exports=n},{"./source/file.js":19,"./source/url.js":20,"./utils/hash2UrlParams.js":23,events:2}],22:[function(e,t,r){var n=function(e,t){t.on("data",function(t){e.emit("data",t)}),t.on("end",function(){e.emit("end")}),t.on("error",function(t){e.emit("error",t)}),t.on("queue",function(t){e.emit("queue",t)})};t.exports=n},{}],23:[function(e,t,r){var n=function(e){var t="";return e&&(t="&"+Object.keys(e).map(function(t){return t+"="+e[t]}).join("&")),t};t.exports=n},{}]},{},[15]);