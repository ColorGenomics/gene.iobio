<!DOCTYPE html>
<html>
<head>
	<title>gene inspector.iobio</title>
	<!-- libraries -->
	<script src="assets/js/jquery.1.11.1.min.js"></script>
	<script src="assets/js/jquery-ui.min.js"></script>
	<script src="assets/js/handlebars-v2.0.0.min.js"></script>	
	<script src="assets/js/typeahead.bundle.min.js"></script>	
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>	
	<script src="assets/js/d3.min.js"></script>	

	<!-- bam.iobio libraries -->
	<script src="assets/js/class.js"></script>
    <script src="assets/js/bam.js"></script>
    <script src="assets/js/bin.js"></script>
    <script src="assets/js/inflate.js"></script>
    <script src="assets/js/binary.js"></script>

    <!-- vcf.iobio libraries -->
    <script src="assets/js/jdataview.js"></script>
    <script src="assets/js/jparser.js"></script>
    <script src="assets/js/inflate.js"></script>
    <script src="assets/js/pako_deflate.min.js"></script>
    <script src="assets/js/jsbgzf.js"></script>
    <script src="assets/js/js-bv-sampling.js"></script>
    <script src="assets/js/js-local-vcf.js"></script> 
    <script src="assets/js/js-bv-common.js"></script>
    <script src="assets/js/js-local-bam.js"></script>




	<!-- fonts -->
	<link href='http://fonts.googleapis.com/css?family=Lato:300,400|Quattrocento+Sans:400,700|Open+Sans:400,600|Montserrat|Quicksand:400|Raleway' rel='stylesheet' type='text/css'>


	<!-- css -->
	<link rel="stylesheet" href="assets/css/jquery-ui.css" />	
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/gene.d3.css" />
    <link rel="stylesheet" href="assets/css/site.css" />

        <!-- handlebar templates -->
    <script id='track-legend-template' type="text/x-handlebars-template">     
        <div id="track-legend">
         <div>
          <div style="margin-top: -6px;">

              <svg id="snp" class="type" width="34" height="14" transform="translate(0,0)">
                <text class="name" x="10" y="9" style="fill-opacity: 1;font-size: 10px;">SNP</text>
                <rect class="variant snp" rx="1" ry="1" x="1" width="8" y="2" height="8" style="opacity: 1; fill: none; stroke: rgb(0, 0, 0); stroke-width: 1px;"></rect>
              </svg>
              <svg id="del" class="type" width="34" height="14" transform="translate(0,0)">
                <text class="name" x="10" y="9" style="fill-opacity: 1;font-size: 10px;">DEL</text>       
                <polygon class="variant del" points="1,2 5,9 9,2" rx="1" ry="1" x="1" width="6" y="2" height="6" style="fill: none; stroke: rgb(0, 0, 0); stroke-width: 1px; opacity: 1;"></polygon>
              </svg>
              <svg id="ins" class="type" width="34" height="14" transform="translate(0,0)">
                <text class="name" x="10" y="9" style="fill-opacity: 1;font-size: 10px;"> INS</text>
                <polygon class="variant ins" points="1,9 5,2 9,9" rx="1" ry="1" x="1" width="6" y="2" height="6" style="fill: none; stroke: rgb(0, 0, 0); stroke-width: 1px; opacity: 1;"></polygon>
              </svg>

              <span style="padding-left: 10px"></span>
              
              <svg width="48" height="17" transform="translate(0,0)">
                <text class="name" x="2" y="12" style="fill-opacity: 1;font-size: 11px;font-style: bold;">Color by:</text>
              </svg>

              <svg id="impact-scheme" class="current" width="55" height="15" transform="translate(0,0)">
                <text class="name" x="2" y="10" style="fill-opacity: 1;font-size: 11px;font-style: bold;">IMPACT</text>
              </svg>

              <svg id="HIGH" class="impact" width="61" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">High</text>
                <rect class="variant  impact_HIGH" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="MODERATE" class="impact" width="57" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">Moderate</text>
                <rect class="variant  impact_MODERATE" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="MODIFIER" class="impact" width="70" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">Modifier</text>
                <rect class="variant  impact_MODIFIER" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="LOW" class="impact" width="47" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">Low</text>
                <rect class="variant  impact_LOW" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="NOIMPACT" class="impact" width="57" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">No Impact</text>
                <rect class="variant  impact_NOIMPACT" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
          </div>
          <div style="padding-left: 174px;">

              
              <svg id="effect-scheme" width="55" height="15" transform="translate(0,0)">
                <text class="name" x="2" y="10" style="fill-opacity: 1;font-size: 11px;font-style: bold;">EFFECT</text>
              </svg>


              <svg id="frameshift" class="effect nocolor" width="61" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">Frameshift</text>
                <rect class="variant  effect_frameshift" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="missense" class="effect nocolor" width="57" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">Missense</text>
                <rect class="variant  effect_missense" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="synonymous" class="effect nocolor" width="70" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">Synonymous</text>
                <rect class="variant  effect_synonymous" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="mirna" class="effect nocolor" width="47" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">miRNA</text>
                <rect class="variant  effect_mirna" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="regulatory" class="effect nocolor" width="62" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">Regulatory</text>
                <rect class="variant  effect_regulatory" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="indel" class="effect nocolor" width="38" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">Indel</text>
                <rect class="variant  effect_indel" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="splice" class="effect nocolor" width="44" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">Splice</text>
                <rect class="variant  effect_splice" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="intron" class="effect nocolor" width="43" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">Intron</text>
                <rect class="variant  effect_intron" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="utr" class="effect nocolor" width="38" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">UTR</text>
                <rect class="variant  effect_utr" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="downstream" class="effect nocolor" width="65" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">Downstream</text>
                <rect class="variant  effect_downstream" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="upstream" class="effect nocolor" width="58" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">Upstream</text>
                <rect class="variant  effect_upstream" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="other" class="effect nocolor" width="40" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">Other</text>
                <rect class="variant  effect_other" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="NOEFFECT" class="impact" width="57" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">No Effect</text>
                <rect class="variant  effect_NOEFFECT" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
            </div>


            <div id="compare-legend" class="hide" style="padding-left: 174px;">

              
              <svg id="compare-scheme" width="55" height="15" transform="translate(0,0)">
                <text class="name" x="2" y="10" style="fill-opacity: 1;font-size: 11px;font-style: bold;">COMPARE CALL SETS</text>
              </svg>


              <svg id="unique" class="compare nocolor" width="61" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">Unique</text>
                <rect class="variant  compare_unique" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
              <svg id="common" class="compare nocolor" width="54" height="14" transform="translate(0,0)">
                <text class="name" x="9" y="9" style="fill-opacity: 1;font-size: 10px;">Common</text>
                <rect class="variant  compare_common" rx="1" ry="1" x="1" width="6" y="2" height="6" style="opacity: 1;"></rect>
              </svg>
            </div>

          </div>
        </div>
    </script>
    
</head>


<body>
 <div id="container">
    <div class="box-shadow">

    	<section id="app-title-section">
    	   <span class="iobioapp">gene</span><span class="iobio">.iobio</span>
            <span id="bloodhound" >
                <input class="typeahead" style="margin-top: 5px" type="text" placeholder="Search By Gene Name or Region (chr2:3000000-3000010)">
            </span>
           <span class="iobioproject">
            an iobio project
           </span>   
        </section>



        <div id="region-track" class="track">
            <div class="track-info results">
              <div id="gene-name"></div>  
              <div id="gene-region-info">
              </div>
            </div>

            <div class="track-chart">

                <div id="region-chart"></div>
            </div>
        </div>


<!--
        <div id="view-finder-track" class="track">
            <div class='track-info'>Zoom into a region</div>  
            <div id="view-finder-chart" class="track-chart"></div>           
        </div>
-->
        
        <div id="gene-track" class="track hide">
            <div class="track-info">
                <div>Zoom into a Region</div>
                <div >
                  <div id="select-transcript" style="float: left;">

                    <div id="transcript-btn-group" class="btn-group" style="display:  inline;">
                      <button id="transcript-dropdown-button" type="button" style="height: 42px;" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                        Choose Transcript <span class="caret"></span>
                      </button>
                      <ul id="transcript-menu" class="dropdown-menu" role="menu" style="min-width: 610px">
                        <li id="transcript-menu-item">
                        </li>
                      </ul>
                    </div>
                </div>     


                </div>

            </div>
            <div id="gene-viz" class="track-chart"></div>               
        </div>


        <div id="zoom-region-track" class="track hide">
            <div  class='track-info'></div>  
            <div class="track-chart">
                <div>
                    <input type="text" id="zoom-region-start"></input>
                    <input type="text" id="zoom-region-end"></input>
                </div>
                <div id="zoom-region-chart" ></div>
            </div>
        </div>
    </div>  




	<div id="vcf-track" class="track box-shadow hide" >
        <div class="track-info" style="margin-bottom: 10px;">
            <span class="stats-label">Examine variants in gene</span>
            <span class="loader" style="padding-left: 10px;">
                <img src="assets/images/loading-squares.gif"/>
            </span>
            <div class="stats-box">
                <div id="add-vcf-track" style="float: left;">

                    <div class="btn-group" style="display:  inline;">
                      <button type="button" style="height: 42px;" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                        Load File <span class="caret"></span>
                      </button>
                      <ul class="dropdown-menu" role="menu">
                        <li>
                            <div class="file" onClick="onVcfFileButtonClicked()">
                                <input type="file" name="files[]" id="vcf-file"  multiple />
                                <label class="file-button" for="vcf-file" >Choose VCF File</label>
                            </div>
                        </li>
                        <li>
                            <a onClick="displayUrlBox()" href="#">Enter URL for VCF</a>
                        </li>    
                      </ul>
                    </div>

                    <div id="url-input-group" class="input-group" style="min-width: 300px;max-width: 600px;">
                        <input id="url-input" type="text" class="form-control" placeholder="Search for..." >
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="button">Go</button>
                        </span>
                    </div>
                </div>     

            </div>            
        </div>          
        <div class="track-chart">
            <div>
                 <div class="variant-count badge" id="vcf-count" style="margin-bottom: 4px;"></div>
            </div>
            <div id="vcf-legend"></div>
            <div id="vcf-variants"></div>
        </div>
    </div>

    <div id="filter-track" class="track box-shadow hide">
        <div class="track-info">
          <span class="stats-label">Filter Variants</span>
        </div>    

        <div class="track-chart">
             <div id="variant-legend"></div>
        </div>
    </div>


    <div id="fb-track" class="track box-shadow hide" >
        <div class="track-info">
            <span class="stats-label">Discover missing variants</span>
            <span class="loader" style="padding-left: 10px;">
                <img src="assets/images/loading-squares.gif"/>
            </span>
            <div>
                <button class="btn btn-default" onClick="callVariants()">Call Freebayes</button>
            </div>
        </div>    

        <div class="track-chart">
             <div>
                 <div class="variant-count badge" id="fb-count" style="margin-bottom: 4px;"></div>
             </div>
             <div id="fb-legend"></div>

             <div id="fb-variants"></div>
        </div>
    </div>




    <div id="bam-track" class="track box-shadow hide" >
        <div class="track-info">
            Examine alignments for gene
            <div id="add-bam-track" style="float: left;">

                <div class="btn-group" style="display:  inline;">
                  <button type="button" style="height: 42px;" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                    Load File <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" role="menu">
                    <li>
                         <div class="file" onClick="onBamFileButtonClicked()">
                            <input type="file" name="files[]" id="bam-file"  multiple />
                            <label class="file-button" for="bam-file" >Choose BAM File</label>
                        </div>
                    </li>
                    <li>
                        <a onClick="displayBamUrlBox()" href="#">Enter URL for BAM</a>
                    </li>    
                   
                  </ul>
                </div>

                <div id="bam-url-input-group" class="input-group" style="min-width: 300px;max-width: 600px;">
                    <input id="bam-url-input" type="text" class="form-control" placeholder="http://..." >
                    <span class="input-group-btn">
                        <button class="btn btn-default" type="button">Go</button>
                    </span>
                </div>
            </div>     
        </div>

        <div id="bam-depth" class="track-chart"></div>
    </div>




 	<script>
        var div = d3.select("body").append("div")   
            .attr("class", "tooltip")               
            .style("opacity", 0);
    </script>    

    <script src="app/region.d3.js"></script>
    <script src="app/barChartVaryWidth.d3.js"></script>
	<script src="app/line.d3.js"></script>
	<script src="app/gene.d3.js"></script>
	<script src="app/variant.d3.js"></script>
    <script src="app/bam.iobio.js"></script>
	<script type="text/javascript" src="app/vcf.iobio.js"></script>
	<script src="app/app.js"></script>	


 </div>
</body>
</html>